\chapter{Hiện thực hệ thống}
% \section{Công nghệ sử dụng}
% Để hiện thực hệ thống, nhóm quyết định sử dụng các công nghệ sau:
% \begin{itemize}
%     \item ReactJS: Hiện thực UI, frontend.
%     \item Java Springboot: Hiện thực microservice, backend.
%     \item PostgresSQL: Hệ cơ sở dữ liệu lưu trữ thông tin.
%     \item Kubernetes: Deploy các microservice.
%     \item Minikube: Chạy Kubernetes cluster trên local.
%     \item Terraform: Khởi tạo 
% \end{itemize}

% \section{Giới hạn phạm vi}
% \subsection{Về mặt nghiệp vụ}
% \noindent Sau khi bàn bạc, nhóm đi tới thống nhất là sẽ hiện thực phần Trang chủ (Home page - Catalog), vì đó là thành phần mà người dùng sẽ gặp đầu tiên khi bắt đầu truy cập vào hệ thống.
% \subsection{Về mặt thành phần hệ thống}
% \noindent Sau khi cân nhắc kỹ lưỡng, để đảm bảo cho phiên bản demo thể hiện được trọn vẹn và đầy đủ nhất các tính chất cốt lõi của hệ thống, nhóm đã giới hạn phạm vi hiện thực của hệ thống xuống còn các thành phần như sau:
% \begin{itemize}
%     \item Frontend: Trang chủ - Catalog, thể hiện danh sách các mặt hàng đang được bày bán 
%     \item Backend: Catalog service, cung cấp API danh sách sản phẩm.
%     \item Minikube cluster: Cung cấp môi trường Kubernetes cluster local trên máy tính cá nhân.
%     \item Deployment: Thành phần cơ bản nhất của hệ thống, dùng để quản lý trực tiếp các pod.
%     \item Service: Một lớp ảo hóa để các thành phần khác có thể truy cập tới các pod.
%     \item Ingress: Đóng vai trò như reverse proxy, cung cấp API gateway để kết nối từ bên ngoài cluster tới service.
%     \item Horizontal Pod Autoscaler: Dùng để tăng hoặc giảm số pod một cách tự động, dựa trên các thông số (metrics) của chính các pod đó.
% \end{itemize}
\section{Lựa chọn công nghệ và thư viện}
\section{Mã nguồn}
\subsection{Quản lý mã nguồn}
\noindent Git là một hệ thống quản lý phiên bản mã nguồn mở rất phổ biến, được sử dụng để quản lý mã nguồn trong các dự án phần mềm. Nó được Linus Torvalds phát triển vào năm 2005 và đã trở thành một công cụ không thể thiếu trong cộng đồng phần mềm mã nguồn mở. Git giúp các nhà phát triển dễ dàng và hiệu quả làm việc trên các phiên bản khác nhau của cùng một dự án, từ đó hỗ trợ quản lý và giám sát quá trình phát triển phần mềm. \\[0.5cm]
Nhóm đã lựa chọn \textbf{GitHub} để quản lý mã nguồn. GitHub là một dịch vụ lưu trữ mã nguồn trực tuyến (source code repository) và nền tảng hợp tác phát triển phần mềm dựa trên Git. GitHub cho phép các nhà phát triển lưu trữ, quản lý và chia sẻ mã nguồn của các dự án phần mềm.\\[0.5cm]
Ngoài ra, để việc đóng góp của các thành viên được diễn ra một cách bài bản và khoa học, nhóm đã định ra một bộ quy tắc về cách đặt tên branch, cách tạo, duyệt, gộp nội dung từ pull request vào branch chính, sẽ được trình bày cụ thể hơn ở phần phụ lục.

\subsection{Cấu trúc mã nguồn}
\noindent Nhóm đã tận dụng Github để quản lý mã nguồn cho 2 nội dung quan trọng nhất của đồ án, là báo cáo (được viết bằng Latex) và hệ thống, tương ứng với 2 repository. Mỗi repository đều có README ghi chú đầy đủ các nội dung hướng dẫn, giúp mỗi thành viên có thể nắm được các thông tin cơ bản của repository, đồng thời thực hiện các bước thiết lập nếu cần, trước khi có thể đóng góp nội dung vào đó.
\subsubsection{Mã nguồn báo cáo}
\noindent Do nội dung báo cáo không ít, vì vậy nhóm không ghi hết toàn bộ nội dung vào 1 file tex duy nhất, mà được chia ra thành nhiều file với cấu trúc như hình \ref{fig:thesis_source_code_structure}:
\begin{itemize}
    \item Thư mục \textbf{images}: Chứa toàn bộ các hình ảnh được sử dụng cho báo cáo. Bên trong còn được chia ra thành nhiều thư mục con, ứng với từng thành viên. Mỗi thành viên sẽ tự quản lý những hỉnh ảnh mà mình sử dụng trong báo cáo.
    \item Thư mục \textbf{sections}: Chứa nội dung của các chương trong báo cáo. Mỗi chương sẽ là 1 file tex riêng.
    \item File \textbf{main.tex}: Là khung xương của toàn bộ báo cáo, chứa các thiết lập, đồng thời là điểm bắt đầu để latex có thể biên tập nội dung.
    \item File \textbf{README.md}: Chứa đựng các thông tin cần thiết về repository. 
\end{itemize}
\begin{figure}[H]
    \begin{center}
        \includegraphics[scale = 1.5]{images/hanh/thesis-source-code-screenshot.png}
        \vspace*{2mm}
    \end{center}
    \caption{Cấu trúc mã nguồn của báo cáo}
    \label{fig:thesis_source_code_structure}

\end{figure}
\subsubsection{Mã nguồn hệ thống}
\noindent Nhằm đáp ứng cho yêu cầu của đề tài và giải pháp tương ứng, hệ thống được triển khai theo kiến trúc microservice, với mỗi microservice sẽ đáp ứng một chức năng cụ thể. Để việc quản lý mã nguồn các dịch vụ này diễn ra một cách tập trung và đồng bộ, toàn bộ mã nguồn hệ thống sẽ được lưu trữ trong một repository duy nhất, được triển khai theo kiến trúc monorepo, bằng cách sử dụng \textbf{yarn workspace} và \textbf{turbo}. Cấu trúc cây thư mục sẽ trông như hình \ref{fig:ecomm_app_source_code}.
\begin{itemize}
    \item Thư mục \textbf{apps}: Chứa toàn bộ mã nguồn của các microservice. Các dịch vụ này được chia vào 3 thư mục con:
    \begin{itemize}
        \item \textbf{backend}: Chứa các microservice với mục đích hiện thực các logic hệ thống, đồng thời chứa các API để trình duyệt có thể giao tiếp.
        \item \textbf{database}: Chứa các microservice với mục đích truy xuất database. Các logic khi query, insert với database sẽ được thực hiện bởi các dịch vụ này.
        \item \textbf{frontend}: Chứa mã nguồn cho các microservice dùng để hiển thị giao diện cho người dùng. Hiện tại, do không đủ thời gian nên nhóm vẫn chưa thực hiện kiến trúc microservice cho frontend.
    \end{itemize}
    \item Thư mục \textbf{deploy}: Chứa các cấu hình phục vụ cho việc triển khai hệ thống. Hiện tại có 2 thư mục con:
    \begin{itemize}
        \item \textbf{k8s-ms}: Chứa các cấu hình phục vụ cho việc triển khai hệ thống thương mại điện tử lên Kubernetes, bao gồm các dịch vụ như ingress, deployment, statefulset, v.v.
        \item \textbf{rabbitmq}: Chứa các cấu hình phục vụ cho việc triển khai RabbitMQ.
    \end{itemize}
\end{itemize}
\begin{figure}[H]
    \begin{center}
        \includegraphics[scale = 1.5]{images/hanh/ecomm-app-source-code.png}
        \vspace*{2mm}
    \end{center}
    \caption{Cấu trúc mã nguồn của hệ thống}
    \label{fig:ecomm_app_source_code}
\end{figure}
\section{Giao diện hệ thống}
\subsection{Trang đăng nhập}
\noindent Sau khi đăng nhập thành công, hệ thống chuyển đến trang chủ, nếu người dùng chưa đăng ký tài khoản, chọn nút đăng ký, hệ thống sẽ chuyển đến trang đăng ký
\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.35]{images/hieu/chap-5/login.png}
    \vspace*{3mm}
    \caption{Giao diện trang đăng nhập}
    \end{center}
\end{figure}

\subsection{Trang đăng ký tài khoản}
\noindent Sau khi đăng ký tài khoản thành công, hệ thống chuyển đến trang đăng nhập, nếu đã có tài khoản, chọn nút đăng nhập.
\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.35]{images/hieu/chap-5/signup.png}
    \vspace*{3mm}
    \caption{Giao diện trang đăng ký}
    \end{center}
\end{figure}
\subsection{Trang chủ - Catalog}
\noindent Giao diện trang chủ gồm các thành phần:
\begin{itemize}
    \item Header: Hiển thị logo, tên cửa hàng, nút đăng nhập, giỏ hàng, nút xem thông báo.
    \item Sidebar: Hiển thị danh mục các sản phẩm
    \item Danh sách giảm giá nổi bật
    \item Danh sách tất cả sản phẩm dưới dạng phân trang, thông tin sản phẩm như tên, số lượng trong kho, giá, đánh giá.
    \item Thanh tìm kiếm sản phẩm
    \item Lọc sản phẩm theo khoảng giá
    \item Footer: Hiển thị thông tin liên hệ, thông tin cửa hàng.
    \item Modal: Hiển thị thông tin chi tiết sản phẩm khi người dùng click vào sản phẩm.
\end{itemize}
\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.35]{images/hieu/chap-5/catalog-1.png}
    \vspace*{3mm}
    \caption{Giao diện trang chủ - Slider giảm giá - Danh mục sản phẩm}
    \end{center}
\end{figure}

\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.35]{images/hieu/chap-5/catalog-2.png}
    \vspace*{3mm}
    \caption{Giao diện trang chủ - Danh sách sản phẩm }
    \end{center}
\end{figure}

\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.4]{images/hieu/chap-5/search.png}
    \vspace*{3mm}
    \caption{Giao diện trang chủ - Tìm kiếm và lọc sản phẩm }
    \end{center}
\end{figure}
\subsection{Trang chi tiết sản phẩm}
\begin{itemize}
    \item Hiển thị đầy đủ và chi tiết các thông tin từng sản phẩm của cửa hàng.
    \item Chọn nút mua ngay để mua trực tiếp sản phẩm.
    \item Chọn nút thêm vào giỏ hàng để thêm sản phẩm vào giỏ hàng.
\end{itemize}
\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.4]{images/hieu/chap-5/product-detail.png}
    \vspace*{3mm}
    \caption{Giao diện trang chi tiết sản phẩm}
    \end{center}
\end{figure}
\subsection{Trang giỏ hàng}
\begin{itemize}
    \item Hiển thị danh sách các sản phẩm người dùng có dự định mua.
    \item Hiển thị số lượng từng sản phẩm, tổng phụ, phí vận chuyển, tổng cuối cùng.
    \item Người dùng có thể điều chỉnh số lượng cũng như xóa sản phẩm khỏi giỏ hàng.
    \item Chọn nút thanh toán để tạo đơn hàng các sản phẩm trong giỏ hàng.
\end{itemize}

\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.4]{images/hieu/chap-5/cart.png}
    \vspace*{3mm}
    \caption{Giao diện trang giỏ hàng}
    \end{center}
\end{figure}
\subsection{Trang đặt hàng - Thanh toán}
\begin{itemize}
    \item Hiển thị danh sách các sản phẩm người dùng muốn mua.
    \item Hiển thị số lượng từng sản phẩm, tổng phụ, phí vận chuyển, tổng cuối cùng.
    \item Thông tin người dùng, địa chỉ giao hàng.
    \item Chọn nút thanh toán để hoàn tất tạo đơn hàng.
\end{itemize}

\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.4]{images/hieu/chap-5/payment.png}
    \vspace*{3mm}
    \caption{Giao diện trang đặt hàng}
    \end{center}
\end{figure}
\subsection{Trang quản lý đơn hàng}
\begin{itemize}
    \item Hiển thị danh sách các đơn hàng mà người dùng đã đặt dưới dạng phân trang.
    \item Thông tin đơn hàng như: mã đơn hàng, ngày đặt hàng, tổng tiền, phương thức thanh toán, trạng thái đơn hàng.
    \item Nhấn chọn từng đơn hàng để xem chi tiết hơn.
    \item Lọc đơn hàng theo trạng thái hoặc theo ngày đặt hàng.
\end{itemize}

\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.43]{images/hieu/chap-5/ordered.png}
    \vspace*{3mm}
    \caption{Giao diện trang quản lý đơn hàng}
    \end{center}
\end{figure}
\subsection{Trang chi tiết đơn hàng}
\noindent Hiển thị thông tin chi tiết của từng đơn hàng.
\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.4]{images/hieu/chap-5/ordered-detail.png}
    \vspace*{3mm}
    \caption{Giao diện trang chi tiết đơn hàng}
    \end{center}
\end{figure}
\subsection{Trang quản lý tài khoản}
\begin{itemize}
    \item Hiển thị thông tin người dùng như: tên đầy đủ, email, số điện thoại.
    \item Thay đổi thông tin nếu muốn, nhấn lưu thay đổi để cập nhật lên hệ thống, tương tự với đổi mật khẩu.
\end{itemize}

\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.4]{images/hieu/chap-5/account.png}
    \vspace*{3mm}
    \caption{Giao diện trang quản lý tài khoản}
    \end{center}
\end{figure}
\subsection{Trang quản lý thông báo}
\begin{itemize}
    \item Hiển thị danh sách các thông báo mà hệ thống đã gửi cho người dùng.
    \item Hiển thị tất cả thông báo.
    \item Hiển thị riêng các thông báo chưa đọc.
    \item Thông tin chi tiết thông báo như: nội dung, thời gian.
    \item Nhấn từng thông báo để xem chi tiết.
    \item Cập nhật tất cả thông báo thành đã đọc nếu muốn.
\end{itemize}

\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.5]{images/hieu/chap-5/noti.png}
    \vspace*{3mm}
    \caption{Giao diện trang quản lý tất cả thông báo}
    \end{center}
\end{figure}
\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.5]{images/hieu/chap-5/noti-notread.png}
    \vspace*{3mm}
    \caption{Giao diện trang quản lý thông báo người dùng chưa đọc }
    \end{center}
\end{figure}
\subsection{Giao diện popup thông báo mới}
\noindent Hiển thị danh sách các thông báo mới
\begin{figure}[H]
    \begin{center}
    \includegraphics[scale=0.35]{images/hieu/chap-5/popup.png}
    \vspace*{3mm}
    \caption{Giao diện popup thông báo mới}
    \end{center}
\end{figure}